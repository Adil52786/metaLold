% e-book
% Universal LaTeX headers for e-book publications
\documentclass[oneside,10pt]{book}
%% mobile phone optimized
\usepackage[paperwidth=118.8mm,paperheight=68.2mm,margin=2mm]{geometry}
%% font setup for screen reading
\renewcommand{\familydefault}{\sfdefault}\normalfont
%% hyperlinks pdf style
\usepackage[unicode,colorlinks=true]{hyperref}
%% fix heading styles for tiny paper
\usepackage{titlesec}
\titleformat{\chapter}{\Large\bfseries}{\thechapter.}{1em}{}
\titleformat{\section}{\large\bfseries}{\thesection.}{1em}{}
%% fix first blank page
\usepackage{atbegshi}% http://ctan.org/pkg/atbegshi
\AtBeginDocument{\AtBeginShipoutNext{\AtBeginShipoutDiscard}}
% graphics
\usepackage[pdftex]{graphicx}
\usepackage{calc}
\newcommand{\fig}[2]{\noindent\includegraphics[#2]{#1}}
\newcommand{\tfig}[2]{\raisebox{2ex-\height}{\noindent\includegraphics[#2]{#1}}}

%% bibliography
%\usepackage{titlesec}
\newcommand{\bibfig}[1]{\fig{#1}{height=.56\textheight}}

% xcolor fixes
\usepackage{xcolor}
\definecolor{red}{rgb}{0.7,0,0}
\definecolor{green}{rgb}{0,0.3,0}
\definecolor{blue}{rgb}{0,0,0.5}
\definecolor{magenta}{rgb}{0.7,0,0.7}

% Cyrillization
%% \usepackage[T1,T2A]{fontenc}
\usepackage[utf8]{inputenc}
%% \usepackage[cp1251]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{indentfirst}

% relative sectioning
\usepackage{ifthen}
\newcounter{secdepth}\setcounter{secdepth}{0}
\newcommand{\secup}{\addtocounter{secdepth}{1}}
\newcommand{\secdown}{\addtocounter{secdepth}{-1}}
\newcommand{\secrel}[1]{
\ifthenelse{\equal{\value{secdepth}}{0}}{\part{#1}}{}
\ifthenelse{\equal{\value{secdepth}}{-1}}{\chapter{#1}}{}
\ifthenelse{\equal{\value{secdepth}}{-2}}{\section{#1}}{}
\ifthenelse{\equal{\value{secdepth}}{-3}}{\subsection{#1}}{}
\ifthenelse{\equal{\value{secdepth}}{-4}}{\subsubsection{#1}}{}
}
\newcommand{\secly}[1]{
\section*{#1}
\addcontentsline{toc}{section}{#1}
}
\newcommand{\subsecly}[1]{
\subsection*{#1}
\addcontentsline{toc}{subsection}{#1}
}

% misc
%% [nosep] option in lists/enums
\usepackage{enumitem}
%% complex tables
\usepackage{multirow}
%% frames
\usepackage{framed}

%% typical macros
\newcommand{\email}[1]{$<$\href{mailto:#1}{#1}$>$}
\newcommand{\note}[1]{\footnote{\ #1}}
\renewcommand{\emph}[1]{\textcolor{blue}{#1}}
\newcommand{\cp}[1]{\note{\copyright\ #1}}
\newcommand{\term}[1]{\textcolor{green}{\textit{#1}}}
\newcommand{\termdef}[2]{\textcolor{red}{\textbf{\textit{#1}}}\index{#2}}

\newcommand{\file}[1]{\texttt{#1}}
\newcommand{\class}[1]{\texttt{#1}}
\newcommand{\var}[1]{\texttt{#1}}
\newcommand{\fn}[1]{\texttt{#1}}

% comp
\newcommand{\emc}{$C$}
\newcommand{\cpp}{$C^{+_+}$}
\newcommand{\java}{$Java$}
\newcommand{\py}{\texttt{\textbf{Python}}}
\newcommand{\rpy}{\texttt{\textbf{RPython}}}
\newcommand{\pp}{\texttt{\textbf{PyPy}}}
\newcommand{\lisp}{$Lisp$}
\newcommand{\F}{\texttt{\textbf{Форт}}}
\newcommand{\js}{$JS$}
\newcommand{\metal}{\texttt{\textbf{metaL}}}
\newcommand{\prolog}{\texttt{\textbf{Prolog}}}
\newcommand{\pyf}{$pyF$}
\newcommand{\st}{$Smalltalk$}
\newcommand{\self}{$Self$}
\newcommand{\A}{Android}
\newcommand{\eclipse}{Eclipse}
\newcommand{\linux}{Linux}
\newcommand{\win}{Windows}
\newcommand{\wasm}{WASM}
\newcommand{\ems}{Emscripten}

\newcommand{\cm}[1]{Cortex-M#1}

%% listings
\usepackage{verbatim}
\usepackage{listings}
\lstset{
basicstyle=\small,
frame=single,
numbers=left,numberstyle=\small,numbersep=2mm,
xleftmargin=3mm,xrightmargin=2mm,
tabsize=4,
keywordstyle=\color{red},
commentstyle=\color{blue},
extendedchars=\true,
% fix russian comments: https://dxdy.ru/post509540.html
keepspaces = true,
%breaklines=false,breakatwhitespace=true
}
\newcounter{lstcounter}
\newcommand{\lst}[2]{\lstinputlisting[#2]{#1}}
% \noindent\refstepcounter{lstcounter}
% \noindent\begin{minipage}{\textwidth}
% \lstinputlisting[#2]{#1}
% \end{minipage}\\}
